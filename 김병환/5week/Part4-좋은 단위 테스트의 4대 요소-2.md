# 📚 4장 좋은 단위테스트의 4대 요소

## 📖 4.4 이상적인 테스트를 찾아서

___

1. 회귀 방지
2. 리택터링 내성
3. 빠른 피드백
4. 유지 보수성

위 4가지 특성을 곱하면 테스트의 가치가 결정된다.

- 즉, 어떤 특성이라도 0이되면 테스트의 가치는 0이다.

테스트를 포함한 모든 코드는 책임이다. 최소한으로 필요한 가치로 임계치를 상당히 높게 설정하고 이 임계치를 충족하는 테스트만 테스트 스위트에 남겨라.

### 🔖 4.4.1 이상적인 테스트를 만들 수 있는가?

회귀 방지, 리팩터링 내성, 빠르 피드백은 상호 배타적이므로 모두 최대로 하는 것은 불가능하다.
즉, 모두 최대의 가치를 지니는 이상적인 테스트를 만드는 것은 불가능하다.

### 🔖 4.4.2 극단적인 사례 1: 엔드 투 엔드 테스트

E2E 테스트의 장점

- 많은 코드를 테스트하므로 회귀 방지⬆️
- 거짓 양성에 면역이 돼 리팩터링 내성⬆️

E2E 테스트의 단점

- 느린속도로 인한 느린 피드백

### 🔖 4.4.3 극단적인 사례 2: 간단한 테스트

간단한 테스트의 장점

- 매우 빠르게 실행되어 빠른 피드백
- 거짓 양성 가능성이 상당히 낮아 리팩터링 내성⬆️

간단한 테스트의 단점

- 기반 코드에 실수할 여지가 많지 않기 때문에 회귀 방지⬇️

### 🔖 4.4.4 극단적인 사례 3: 깨지기 쉬운 테스트

깨지기 쉬운 테스트의 장점

- 빠르게 실행되어 빠른 피드백
- 회귀 방지⬆️

깨지기 쉬운 테스트의 단점

- 리팩터링 내성⬇️

### 🔖 4.4.5 이상적인 테스트를 찾아서: 결론

완벽한 점수를 가진 이상적인 테스트를 만드는 것은 불가능 하다.
유지 보수성은 엔드 투 엔드 테스트를 제외하고 처음 세 가지 특성과 상관관계가 없다.

결론은 리팩터링 내성을 최대한 많이 갖는 것을 목표로 하되, 회귀방지와 빠른 피드백 사이의 선택으로 귀결된다.

- 리팩터링 내성은 중간단계가 없기 때문이다!
- 회귀 방지와, 빠른 피드백은 중간단계가 있다!

## 📖 4.5 대중적인 테스트 자동화 개념 살펴보기

___

### 🔖 4.5.1 테스트 피라미드 분해

테스트 피라미드: 테스트 유형 간의 일정한 비율

![4.11](./img/4.11.png)

- 층의 너비는 테스트 스위트에서 해당 테스트가 얼마나 보편적인지를 나타낸다.
- 층의 높이는 이러한 테스트가 최종 사용자의 동작을 얼마나 유사하게 흉내내는지 나타낸다.
- 피라미드 상단의 테스트는 회귀 방지에 유리하고, 하단은 실행 속도를 강조한다.

### 🔖 4.5.2 블랙박스 테스트와 화이트박스 테스트 간의 선택

#### 블랙박스 테스트

- 시스템의 내부 구조를 몰라도 시스템의 기능을 검사
- 어플리케이션이 어떻게 해야 하는지가 아니라 무엇을 해야 하는지를 중심으로 구축

#### 화이트박스 테스트

- 어플리케이션의 내부 작업을 검증하는 방식
- 테스트가 소스 코드에서 파생됨

||회귀 방지|리팩터링 내성
|:---:|:---:|:---:
|화이트박스 테스트|좋음|나쁨
|블랙박스 테스트|나쁨|좋음

테스트를 작성할 때는 블랙박스 테스트가 바람직(리팩터링 내성⬆️)하지만, 분석할 때는 화이트박스 방법을 사용할 수 있다.