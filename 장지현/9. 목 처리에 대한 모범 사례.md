# 9.목 처리에 대한 모범 사례
> 목은 테스트 대상 시스템과 의존성 간의 상호 작용을 모방하고 검사하는 데 도움이 되는 테스트 대역이다.
> 목은 비관리 의존성에만 적용해야 한다. (다른것에 사용하면 깨지기 쉬운 테스트가 됨)
## 목의 가치를 극대화하기
1. 시스템 끝에서 상호 작용 검증
> 시스템 끝에서 비관리 의존성과의 상호 작용을 검증
> 회귀 방지, 리팩터링 내성 향상 -> 잠재적인 거짓 양성에 노출될 가능성 낮아짐

2. 목을 스파이로 대체하기
> 스파이는 목과 같은 목적을 수행하는 테스트 대역
> 스파이는 수동으로 작성, 목은 프레임워크의 도움을 받아 생성
> 스파이는 종종 직접 작성한 목이라고도 한다.
> 스파이는 검증 단계에서 코드를 재상용해 테스트 크기를 줄이고 가독성을 향상 시킨다.
> 시스템 끝에 있는 클래스의 경우 스파이가 목보다 낫다.
> 스파이가 제품코드를 대체했을때는 제품코드 구조가 변경되었을때 별도의 검사점의 역할을 수행한다.

## 목 처리에 대한 모범 사례
1. 비관리 의존성에만 목 적용하기
2. 시스템 끝에 있는 의존성에 대해 상호 작용 검증하기
3. 통하 테스트에서만 목을 사용하고 단위 테스트에서는 하지 않기
    > 도메인 모델에 대한 테스트 -> 단위 테스트
    > 컨트롤러(비관리 의존성)에 대한 테스트 -> 통합 테스트 
4. 항상 목 호출 수 확인하기
    > 테스트당 목이 하나일 필요는 없음
    > 예상하는 호출이 있는지, 예상못한 호출이 있는지 확인 필요 -> 비관리 의존성과 하위 호환성을 지켜야함으로 확인 필요
5. 보유 타입만 목으로 처리하기
    > 서드파티 라이브러리 위에 항상 어댑터를 작성하고, 기본 타입 대신 해당 어댑터를 목으로 처리해야 한다.
